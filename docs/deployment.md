# CBC求解器部署指南

本文档介绍如何部署CBC求解器项目，包括C++版本和Go版本。

## 部署方案

项目提供了四种部署方案，适用于不同的场景：

### 1. Docker容器（源代码上传）

这种方式将源代码和配置文件上传到服务器，然后在服务器上构建Docker镜像。

#### C++版本

```bash
./scripts/deploy-cpp.sh --all --run
```

#### Go版本

```bash
./scripts/deploy-go.sh --all --run
```

**优点**：
- 简单直接，只需一个命令
- 服务器上的代码始终与本地保持同步

**缺点**：
- 需要在服务器上进行编译，可能耗时较长
- 需要服务器有足够的资源

### 2. Docker容器（镜像上传）

这种方式在本地构建Docker镜像，然后将镜像上传到服务器。

#### C++版本

```bash
./scripts/save-and-upload-image-cpp.sh
```

#### Go版本

```bash
./scripts/save-and-upload-image-go.sh
```

**优点**：
- 避免在服务器上进行耗时的编译
- 确保本地和服务器使用完全相同的镜像

**缺点**：
- 镜像文件可能较大，上传时间较长
- 需要处理架构差异（如ARM Mac与x86_64服务器）

### 3. 静态链接可执行文件

这种方式在本地编译出一个静态链接的Linux可执行文件，然后将其上传到服务器。

#### C++版本

```bash
./cpp/build-for-linux-simple.sh
./scripts/upload-linux-executable-cpp.sh
```

#### Go版本

```bash
./go/build-go-for-linux.sh
./scripts/upload-linux-executable-go.sh
```

**优点**：
- 不需要在服务器上安装Docker
- 不需要在服务器上安装任何依赖
- 可执行文件体积小，上传快速

**缺点**：
- 编译过程复杂，需要交叉编译环境
- 只能在相同架构的Linux系统上运行

### 4. 本地编译运行

这种方式直接在本地环境中编译和运行程序。

#### C++版本

```bash
./cpp/build-native-simple.sh
```

#### Go版本

```bash
./go/build-go-native.sh
```

**优点**：
- 最简单直接的方式
- 不需要Docker
- 编译和运行速度快

**缺点**：
- 需要在本地安装CBC及其依赖
- 只能在本地运行，不能直接在其他环境运行

## 服务器配置

在使用部署脚本前，需要修改脚本中的服务器配置：

```bash
# 服务器配置
SERVER_HOST="your-server-ip"
SERVER_PORT="22"
SERVER_USER="your-username"
SERVER_PATH="/path/to/destination"
```

这些配置位于各个部署脚本的开头部分。

## 部署步骤详解

### 1. 准备环境

确保本地已安装：
- Docker（用于构建镜像和交叉编译）
- Go（用于本地编译Go版本）
- SSH客户端（用于连接服务器）

### 2. 选择部署方案

根据您的需求选择合适的部署方案。

### 3. 修改服务器配置

编辑相应脚本中的服务器配置。

### 4. 执行部署

运行相应的部署脚本。

### 5. 验证部署

确认程序在服务器上正常运行。

## 故障排除

### Docker相关问题

- **镜像构建失败**：检查Dockerfile和构建环境
- **容器运行失败**：检查日志和容器配置
- **架构不兼容**：确保使用正确的平台标志（--platform=linux/amd64）

### 编译相关问题

- **依赖缺失**：安装必要的库和工具
- **编译错误**：检查编译器版本和选项
- **链接错误**：确保库路径正确

### 服务器相关问题

- **连接失败**：检查服务器地址、端口和认证信息
- **权限问题**：确保有足够的权限
- **空间不足**：清理服务器磁盘空间

## 安全注意事项

- 不要在脚本中硬编码密码
- 使用SSH密钥认证而不是密码
- 定期更新依赖库和工具
- 使用最小权限原则配置服务器账户
